---
title: "mecp2_analysis_4"
author: "Andrew Willems and Tian Hong"
date: "4/25/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Objective
We are doing  analysis on the new set of cohorts from the Krishnan lab for MECP2. First, we use intraclass correlation coefficient (ICC) values of the Cohort, Cell type, Cell number, and Image variables to determine if we need to build linear mixed effects models. After investigating if we need LMEs we then create heat maps of the MECP2 data. We compare the differences in means between the various conditions.

## Step One
Load needed packages. emmeans is used to perform the pairwise analysis. ggstatsplot is an extension of ggplot with lots of statistical test and visualization support. gt is used for making the nice tables. ICC is used to calculate the intraclass correlation coefficient to tell us if we can treat our predictors (variables) as independent or not. Magrittr is a package that allows us to use pipes (%>%) in our code. mclust allows us to build Gaussian mixture models. modelsummary allows us to make our linear mixed effects (lme) model output more professional looking. nlme is the package that performs the lme model fit. Rstatix is used to do the pairwise t-tests and p-value correction. Tidyverse is used for data manipulation. webshot is used to save our gt tables as .png files.

```{r message=FALSE, echo=FALSE}
#Loading needed packages
library(effectsize)
library(emmeans)
library(ggforce)
library(ggpubr)
library(ggsignif)
library(ggstatsplot)
library(gt)
library(ICC)
library(magrittr)
library(mclust)
library(modelsummary)
library(nlme)
library(rstatix)
library(tidyverse)
library(webshot)
```

## Step Two
Load the data and make separate data frames that are comprised of only left or right hemisphere data. The warning here is okay. When I make all columns numeric it introduces some NAs because not all columns have the same number of rows (some just have no data in that row and therefore they get an NA). I fill those NAs in with a 0. 
```{r tidy=TRUE, tidy.opts=list(arrow=TRUE, indent=2), echo=FALSE, results='hide', eval=TRUE, warning=FALSE}
#Loading the data
setwd("~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Data")
mecp2_data <- read.csv("mecp2_raw_histogram_data.csv", sep = ",")
mecp2_metadata_6wk <- mecp2_data[1:6,1:380]
mecp2_metadata_12wk <- mecp2_data[1:6,381:816]
mecp2_intensity <- mecp2_data[7:2164,2:817]
mecp2_intensity_6wk <- mecp2_intensity[,1:380]
mecp2_intensity_12wk <- mecp2_intensity[,381:816]
mecp2_intensity_6wk <- apply(mecp2_intensity_6wk, 2, as.numeric)
mecp2_intensity_12wk <- apply(mecp2_intensity_12wk, 2, as.numeric)
mecp2_intensity_6wk[is.na(mecp2_intensity_6wk)] <- 0
mecp2_intensity_12wk[is.na(mecp2_intensity_12wk)] <- 0
mecp2_data_processed_6wk <- data.frame(Cell_type=as.character(mecp2_metadata_6wk[1,]),
                                   Cohort=as.character(mecp2_metadata_6wk[2,]),
                                   Condition=as.character(mecp2_metadata_6wk[3,]),
                                   Hemisphere=as.character(mecp2_metadata_6wk[4,]),
                                   Image=as.character(mecp2_metadata_6wk[5,]),
                                   Cell_number=as.character(mecp2_metadata_6wk[6,]))


mecp2_data_processed_12wk <- data.frame(Cell_type=as.character(mecp2_metadata_12wk[1,]),
                                   Cohort=as.character(mecp2_metadata_12wk[2,]),
                                   Condition=as.character(mecp2_metadata_12wk[3,]),
                                   Hemisphere=as.character(mecp2_metadata_12wk[4,]),
                                   Image=as.character(mecp2_metadata_12wk[5,]),
                                   Cell_number=as.character(mecp2_metadata_12wk[6,]))



mecp2_data_processed_6wk <- mecp2_data_processed_6wk[2:817,]
mecp2_data_processed_12wk <- mecp2_data_processed_12wk[2:817,]

head(mecp2_data_processed_6wk)
head(mecp2_data_processed_12wk)
dim(mecp2_data_processed_6wk)
dim(mecp2_data_processed_12wk)
```
Now separating the PV nuclei and the Non-PV nuclei in the metadata file
```{r}
#Metadata
pv_6wk <- filter(mecp2_data_processed_6wk, Cell_type=="PNN-pos")
nonpv_6wk <- filter(mecp2_data_processed_6wk, Cell_type=="PNN-neg")

pv_12wk <- filter(mecp2_data_processed_12wk, Cell_type=="PNN-pos")
nonpv_12wk <- filter(mecp2_data_processed_12wk, Cell_type=="PNN-neg")
```


## Step Three: Building Gaussian Mixed Model (GMMs) for all of our data
```{r message=FALSE, fig.show='hide', echo=FALSE, eval=TRUE, warning=FALSE}
#Doing density estimates for each of the columns of our data frame to get 
#means for further analysis for 6wk data
gmm_mod_6wk <- apply(mecp2_intensity_6wk, 2, densityMclust, G = 1)
```

```{r message=FALSE, fig.show='hide', echo=FALSE, eval=TRUE, warning=FALSE}
#Doing density estimates for each of the columns of our data frame to get 
#means for further analysis for 12wk data
gmm_mod_12wk <- apply(mecp2_intensity_12wk, 2, densityMclust, G = 1)
```


## Step Four: Now plotting and then saving all of the density plots for 6 week year old data 
```{r echo=FALSE, message=FALSE, eval=TRUE}
#Plotting the results and saving mean 1 and mean 2 to do more analysis later
setwd("~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures")
first_means_6wk <- rep(0, 816)
second_means_6wk <- rep(0, 816)
all_plots <- list()
counter <- 1
for(gm in gmm_mod_6wk){
  current_mod <- gm
  first_means_6wk[counter] <- current_mod$parameters$mean[1]
  #second_means_6wk[counter] <- current_mod$parameters$mean[2]
  
  current_mod_ggplot <- as.data.frame(current_mod$density)
  colnames(current_mod_ggplot) <- "density"
  current_mod_ggplot$mean <- first_means_6wk[counter]
  #current_mod_ggplot$mean2 <- second_means_6wk[counter]
  density_plot <- ggplot(data = current_mod_ggplot, aes(x=density)) +
    geom_density(color="blue",
                 fill= "#87ceeb",
                 alpha=0.8) +
    theme(panel.background = element_blank())+
    xlab("Intensity")+ ylab("Density")
  len <- length(all_plots)
  all_plots[[len+1]] <- density_plot
  ggsave(filename = paste0("density_plot_mecp2_6wk_", len, ".svg"), device = "svg",
         dpi = 300, height = 12, width = 12, unit= "cm", plot = density_plot)
  counter <- counter + 1
}

```

## For 12 week old data
```{r echo=FALSE, message=FALSE, eval=TRUE}
#Plotting the results and saving mean 1 and mean 2 to do more analysis later
setwd("~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures")
first_means_12wk <- rep(0, 816)
second_means_12wk <- rep(0, 816)
all_plots <- list()
counter <- 1
for(gm in gmm_mod_12wk){
  current_mod <- gm
  first_means_12wk[counter] <- current_mod$parameters$mean[1]
  #second_means_12wk[counter] <- current_mod$parameters$mean[2]
  
  current_mod_ggplot <- as.data.frame(current_mod$density)
  colnames(current_mod_ggplot) <- "density"
  current_mod_ggplot$mean <- first_means_12wk[counter]
  #current_mod_ggplot$mean2 <- second_means_12wk[counter]
  density_plot <- ggplot(data = current_mod_ggplot, aes(x=density)) +
    geom_density(color="blue",
                 fill= "#87ceeb",
                 alpha=0.8) +
    theme(panel.background = element_blank())+
    xlab("Intensity")+ ylab("Density")
  len <- length(all_plots)
  all_plots[[len+1]] <- density_plot
  ggsave(filename = paste0("density_plot_mecp2_12wk_", len, ".svg"), device = "svg",
         dpi = 300, height = 12, width = 12, unit= "cm", plot = density_plot)
  counter <- counter + 1
}
```



## Step Five: Adding the means of the GMM to our overall data frame
```{r}
#Now appending the mean to the other metadata for this MECP2 data set for the 6 week and 12 week data frames
mecp2_data_processed_6wk$Mean <- first_means_6wk
#mecp2_data_processed_6wk$Mean2 <- second_means_6wk
mecp2_data_processed_6wk$Time <- rep("6 wk", times=nrow(mecp2_data_processed_6wk))
head(mecp2_data_processed_6wk)

mecp2_data_processed_12wk$Mean <- first_means_12wk
#mecp2_data_processed_12wk$Mean2 <- second_means_12wk
mecp2_data_processed_12wk$Time <- rep("12 wk", times=nrow(mecp2_data_processed_12wk))
head(mecp2_data_processed_12wk)
```


Bringing the 6 week and 12 week old data together into a single data frame to reproduce analysis we have seen from collaborators
```{r}
all_nuc_df <- bind_rows(mecp2_data_processed_6wk, mecp2_data_processed_12wk)
all_nuc_df$Cohort <- gsub(x = all_nuc_df$Cohort,
                                    pattern = "#", 
                                    replacement = "")
```


```{r}
mecp2_data_processed_6wk_simp <- mecp2_data_processed_6wk
mecp2_data_processed_6wk_simp <- filter(mecp2_data_processed_6wk_simp,
                                        Condition=="NH" | Condition=="NW")

mecp2_data_processed_6wk_simp_neg <- filter(mecp2_data_processed_6wk_simp, Cell_type=="PNN-neg")
mecp2_data_processed_6wk_simp_pos <- filter(mecp2_data_processed_6wk_simp, Cell_type=="PNN-pos")

mecp2_data_processed_6wk_simp_neg$Condition <- gsub(x = mecp2_data_processed_6wk_simp_neg$Condition, pattern = "NH", replacement = "Het")
mecp2_data_processed_6wk_simp_neg$Condition <- gsub(x = mecp2_data_processed_6wk_simp_neg$Condition, pattern = "NW", replacement = "WT")
mecp2_data_processed_6wk_simp_pos$Condition <- gsub(x = mecp2_data_processed_6wk_simp_pos$Condition, pattern = "NH", replacement = "Het")
mecp2_data_processed_6wk_simp_pos$Condition <- gsub(x = mecp2_data_processed_6wk_simp_pos$Condition, pattern = "NW", replacement = "WT")

#mecp2_data_processed_6wk_simp$Condition <- gsub(x = mecp2_data_processed_6wk_simp$Condition, pattern = "SH", replacement = "Het")
#mecp2_data_processed_6wk_simp$Condition <- gsub(x = mecp2_data_processed_6wk_simp$Condition, pattern = "SW", replacement = "WT")


mecp2_data_processed_6wk_simp_neg$Condition <- factor(mecp2_data_processed_6wk_simp_neg$Condition, levels = c("WT", "Het"))
mecp2_data_processed_6wk_simp_pos$Condition <- factor(mecp2_data_processed_6wk_simp_pos$Condition, levels = c("WT", "Het"))
```


```{r}
mecp2_data_processed_12wk_simp <- mecp2_data_processed_12wk

mecp2_data_processed_12wk_simp <- filter(mecp2_data_processed_12wk_simp,
                                        Condition=="NH" | Condition=="NW")

mecp2_data_processed_12wk_simp_neg <- filter(mecp2_data_processed_12wk_simp, Cell_type=="PNN-neg")
mecp2_data_processed_12wk_simp_pos <- filter(mecp2_data_processed_12wk_simp, Cell_type=="PNN-pos")

mecp2_data_processed_12wk_simp_neg$Condition <- gsub(x = mecp2_data_processed_12wk_simp_neg$Condition, pattern = "NH", replacement = "Het")
mecp2_data_processed_12wk_simp_neg$Condition <- gsub(x = mecp2_data_processed_12wk_simp_neg$Condition, pattern = "NW", replacement = "WT")
mecp2_data_processed_12wk_simp_pos$Condition <- gsub(x = mecp2_data_processed_12wk_simp_pos$Condition, pattern = "NH", replacement = "Het")
mecp2_data_processed_12wk_simp_pos$Condition <- gsub(x = mecp2_data_processed_12wk_simp_pos$Condition, pattern = "NW", replacement = "WT")


mecp2_data_processed_12wk_simp_neg$Condition <- factor(mecp2_data_processed_12wk_simp_neg$Condition, levels = c("WT", "Het"))
mecp2_data_processed_12wk_simp_pos$Condition <- factor(mecp2_data_processed_12wk_simp_pos$Condition, levels = c("WT", "Het"))
```

PV Nuclei
```{r}
mecp2_6_12_neg <- bind_rows(mecp2_data_processed_6wk_simp_neg, mecp2_data_processed_12wk_simp_neg)


#Performing all KW tests for all the combinations of data
overall_test <- mecp2_6_12_neg %>% kruskal_test(formula = Mean~Time)
example_of_pwc <- mecp2_6_12_neg %>% group_by(Time) %>% filter(Time=="6 wk") %>% dunn_test(formula = Mean~Condition, detailed = TRUE, p.adjust.method = "none")
six_wk_comp <- mecp2_6_12_neg %>% group_by(Time) %>% filter(Time=="6 wk") %>% dunn_test(formula = Mean~Condition, detailed = TRUE, p.adjust.method = "none")
twelve_week_comp <- mecp2_6_12_neg %>% group_by(Time) %>% filter(Time=="12 wk") %>% dunn_test(formula = Mean~Condition, detailed = TRUE, p.adjust.method = "none")
wt_v_wt_comp <- mecp2_6_12_neg %>% group_by(Condition) %>% filter(Condition=="WT") %>% dunn_test(formula = Mean~Time, detailed = TRUE, p.adjust.method = "none")
het_v_het_comp <- mecp2_6_12_neg %>% group_by(Condition) %>% filter(Condition=="Het") %>% dunn_test(formula = Mean~Time, detailed = TRUE, p.adjust.method = "none")


#Effect size and effects size interpretation
overall_effect_size <- kruskal_effsize(data = mecp2_6_12_neg, formula = Mean~Time, ci = TRUE)

six_wk_eff_size_df <- mecp2_6_12_neg %>% group_by(Time) %>% filter(Time=="6 wk")
six_wk_eff_size <- hedges_g(data = six_wk_eff_size_df, x = Mean~Condition)



twelve_wk_eff_size_df <- mecp2_6_12_neg %>% group_by(Time) %>% filter(Time=="12 wk")
twelve_wk_eff_size <- hedges_g(data = twelve_wk_eff_size_df, x = Mean~Condition)



wt_v_wt_eff_size_df <- mecp2_6_12_neg %>% group_by(Condition) %>% filter(Condition=="WT")
wt_v_wt_eff_size <- hedges_g(data = wt_v_wt_eff_size_df, x = Mean~Time)


het_v_het_eff_size_df <- mecp2_6_12_neg %>% group_by(Condition) %>% filter(Condition=="Het")
het_v_het_eff_size <- hedges_g(data = het_v_het_eff_size_df, x = Mean~Time)

overall_test_label <- create_test_label(description = "Kruskal-Wallis", statistic.text = quote(italic(chi)^2), statistic = 24.23, p = "<0.0001", parameter = "1", n = 225, effect.size.text = quote(italic(eta)^2), effect.size = 0.104, detailed = TRUE, type = "expression")

#"eta2[H]"

#Now back to doing plotting stuff
mecp2_6_12_neg$Time <- factor(mecp2_6_12_neg$Time, levels = c("6 wk", "12 wk"))

mecp2_6_12_neg$Combo <- paste0(mecp2_6_12_neg$Condition,"_", mecp2_6_12_neg$Time)
mecp2_6_12_neg$Combo <- factor(mecp2_6_12_neg$Combo, levels = c("WT_6 wk", "Het_6 wk", "WT_12 wk", "Het_12 wk"))



total_plot <- ggplot(aes(x=Combo,y=Mean, fill=Condition), data = mecp2_6_12_neg)+
  geom_violin()+ theme(panel.background = element_blank(),
                       plot.title = element_text(hjust = 0.5, face = "bold"),
                       axis.title = element_text(face = "bold"),
                       axis.text = element_text(face = "bold"),
                       legend.position = "none")+
  ylab("Mean MECP2 Intensity (a.u.)")+
  xlab("")+
  geom_sina(seed=123)+
  ggtitle("Non-PV Nuclei")+
  geom_signif(y_position = c(1700, 1500), xmin = c(1.0,3.0), xmax = c(2.0,4.0),
              annotations = c("*", "ns"), tip_length = 0)+
  geom_signif(y_position = 1875, xmin = 1.0, xmax = 3.0, annotations = "*",
              tip_length = 0)+
  geom_signif(y_position = 2000, xmin = 2.0, xmax = 4.0, annotations = "****",
              tip_length = 0)+
  labs(
    subtitle = overall_test_label,
    caption = get_pwc_label(example_of_pwc)
    )
  

total_plot <- total_plot + scale_x_discrete(breaks = c("WT_6 wk","Het_6 wk", "WT_12 wk", "Het_12 wk"),
                                            labels = c("WT \n(n = 47)", "Het \n(n = 58)", "WT \n(n = 60)", "Het \n(n = 60)"))

total_plot <- total_plot + stat_summary(fun=mean, geom="point", shape=23, size=5, color="white", fill="white")

total_plot_non <- total_plot

total_plot_non
```

Non-PV Nuclei
```{r}
mecp2_6_12_pos <- bind_rows(mecp2_data_processed_6wk_simp_pos, mecp2_data_processed_12wk_simp_pos)


#Performing all KW tests for all the combinations of data
overall_test <- mecp2_6_12_pos %>% kruskal_test(formula = Mean~Time)
example_of_pwc <- mecp2_6_12_pos %>% group_by(Time) %>% filter(Time=="6 wk") %>% dunn_test(formula = Mean~Condition, detailed = TRUE, p.adjust.method = "none")
six_wk_comp <- mecp2_6_12_pos %>% group_by(Time) %>% filter(Time=="6 wk") %>% dunn_test(formula = Mean~Condition, detailed = TRUE, p.adjust.method = "none")
twelve_week_comp <- mecp2_6_12_pos %>% group_by(Time) %>% filter(Time=="12 wk") %>% dunn_test(formula = Mean~Condition, detailed = TRUE, p.adjust.method = "none")
wt_v_wt_comp <- mecp2_6_12_pos %>% group_by(Condition) %>% filter(Condition=="WT") %>% dunn_test(formula = Mean~Time, detailed = TRUE, p.adjust.method = "none")
het_v_het_comp <- mecp2_6_12_pos %>% group_by(Condition) %>% filter(Condition=="Het") %>% dunn_test(formula = Mean~Time, detailed = TRUE, p.adjust.method = "none")


#Effect size and effects size interpretation
overall_effect_size <- kruskal_effsize(data = mecp2_6_12_pos, formula = Mean~Time, ci = TRUE)

six_wk_eff_size_df <- mecp2_6_12_pos %>% group_by(Time) %>% filter(Time=="6 wk")
six_wk_eff_size <- hedges_g(data = six_wk_eff_size_df, x = Mean~Condition)



twelve_wk_eff_size_df <- mecp2_6_12_pos %>% group_by(Time) %>% filter(Time=="12 wk")
twelve_wk_eff_size <- hedges_g(data = twelve_wk_eff_size_df, x = Mean~Condition)



wt_v_wt_eff_size_df <- mecp2_6_12_pos %>% group_by(Condition) %>% filter(Condition=="WT")
wt_v_wt_eff_size <- hedges_g(data = wt_v_wt_eff_size_df, x = Mean~Time)


het_v_het_eff_size_df <- mecp2_6_12_pos %>% group_by(Condition) %>% filter(Condition=="Het")
het_v_het_eff_size <- hedges_g(data = het_v_het_eff_size_df, x = Mean~Time)

overall_test_label <- create_test_label(description = "Kruskal-Wallis", statistic.text = quote(italic(chi)^2), statistic = 0.15, p = "0.7", parameter = "1", n = 188, effect.size.text = quote(italic(eta)^2), effect.size = -0.00456, detailed = TRUE, type = "expression")



#Now back to doing plotting stuff
mecp2_6_12_pos$Time <- factor(mecp2_6_12_pos$Time, levels = c("6 wk", "12 wk"))

mecp2_6_12_pos$Combo <- paste0(mecp2_6_12_pos$Condition,"_", mecp2_6_12_pos$Time)
mecp2_6_12_pos$Combo <- factor(mecp2_6_12_pos$Combo, levels = c("WT_6 wk", "Het_6 wk", "WT_12 wk", "Het_12 wk"))



total_plot <- ggplot(aes(x=Combo,y=Mean, fill=Condition), data = mecp2_6_12_pos)+
  geom_violin()+ theme(panel.background = element_blank(),
                       plot.title = element_text(hjust = 0.5, face = "bold"),
                       axis.title = element_text(face = "bold"),
                       axis.text = element_text(face = "bold"),
                       legend.position = "none")+
  ylab("Mean MECP2 Intensity (a.u.)")+
  xlab("")+
  geom_sina(seed=123)+
  ggtitle("PV Nuclei")+
  geom_signif(y_position = c(4300, 4000), xmin = c(1.0,3.0), xmax = c(2.0,4.0),
              annotations = c("ns", "ns"), tip_length = 0)+
  geom_signif(y_position = 4750, xmin = 1.0, xmax = 3.0, annotations = "ns",
              tip_length = 0)+
  geom_signif(y_position = 5100, xmin = 2.0, xmax = 4.0, annotations = "ns",
              tip_length = 0)+
  labs(
    subtitle = overall_test_label,
    caption = get_pwc_label(example_of_pwc)
    )
  

total_plot <- total_plot + scale_x_discrete(breaks = c("WT_6 wk","Het_6 wk", "WT_12 wk", "Het_12 wk"),
                                            labels = c("WT \n(n = 47)", "Het \n(n = 35)", "WT \n(n = 59)", "Het \n(n = 47)"))

total_plot <- total_plot + stat_summary(fun=mean, geom="point", shape=23, size=5, color="white", fill="white")

total_plot_pv <- total_plot

total_plot_pv
```

Combining the plots
```{r}
combo_plot <- ggarrange(total_plot_non, total_plot_pv, nrow = 1, ncol = 2, labels = c("e", "f"))
combo_plot
```
Saving the plots
```{r}
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/mecp2_non_and_pv_together.svg", device = "svg",
       units = "cm", dpi = 300, width = 32, height = 32, plot = combo_plot)
```

```{r}
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/mecp2_non.svg", device = "svg",
       units = "cm", dpi = 300, width = 32, height = 32, plot = total_plot_non)
```

```{r}
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/mecp2_pv.svg", device = "svg",
       units = "cm", dpi = 300, width = 32, height = 32, plot = total_plot_pv)
```


Now performing ICC analysis on the combinations we have previously tested to see if any of the variables have high levels of dependence
```{r}
mecp2_6_12_neg$Cohort <- gsub(x = mecp2_6_12_neg$Cohort,
                                    pattern = "#", 
                                    replacement = "")

#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean, data = mecp2_6_12_neg)

#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean, data = mecp2_6_12_neg)

#For Image
icc_img <- ICCbare(x=factor(Image), y= Mean, data = mecp2_6_12_neg)



#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell number", "Image")

#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for PV Negative MECP2 Data",
  subtitle = "Intraclass Correlation Coefficient (ICC) for Mean 6 week Non-PV MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```


```{r}
mecp2_6_12_pos$Cohort <- gsub(x = mecp2_6_12_pos$Cohort,
                                    pattern = "#", 
                                    replacement = "")

#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean, data = mecp2_6_12_pos)

#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean, data = mecp2_6_12_pos)

#For Image
icc_img <- ICCbare(x=factor(Image), y= Mean, data = mecp2_6_12_pos)



#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell number", "Image")

#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for PV Positive MECP2 Data",
  subtitle = "Intraclass Correlation Coefficient (ICC) for Mean 6 week PV MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```

```{r}
#Now building an LME for non-PV because of high ICC of Cohort. This is the overall model
lme_mod <- lme(Mean~Time, data=mecp2_6_12_neg , random = ~ 1|Cohort)
modelsummary(
  lme_mod,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.95,
  title = "Non-PV Mean",
  coef_rename = c("(Intercept)" = "(Intercept) 6 week", "Time12 wk" = "12 week")
)
```


```{r}
six_wk_comp_df <- mecp2_6_12_neg %>% group_by(Time) %>% filter(Time=="6 wk")

#Now building an LME for non-PV because of high ICC of Cohort. This is the overall model
lme_mod_6wk_comp <- lme(Mean~Condition, data=six_wk_comp_df, random = ~ 1|Cohort)
modelsummary(
  lme_mod_6wk_comp,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.95,
  title = "Non-PV Mean 6 Week Comparison Between Conditions",
  coef_rename = c("(Intercept)" = "(Intercept) WT", "ConditionHet" = "Het")
)
```


```{r}
twelve_week_comp <- mecp2_6_12_pos %>% group_by(Time) %>% filter(Time=="12 wk") %>% dunn_test(formula = Mean~Condition, detailed = TRUE, p.adjust.method = "none")
wt_v_wt_comp <- mecp2_6_12_pos %>% group_by(Condition) %>% filter(Condition=="WT") %>% dunn_test(formula = Mean~Time, detailed = TRUE, p.adjust.method = "none")
het_v_het_comp <- mecp2_6_12_pos %>% group_by(Condition) %>% filter(Condition=="Het") %>% dunn_test(formula = Mean~Time, detailed = TRUE, p.adjust.method = "none")

```







## Step Six: Now separating our data into left and right hemispheres and by PV and non-PV status. Also removing the # sign to keep our data clean and ensure there are no weird processing issues because of mixed data types
```{r echo=FALSE}
#Now separating the data set into left and right hemisphere
mecp2_data_processed_6wk$Cohort <- gsub(x = mecp2_data_processed_6wk$Cohort,
                                    pattern = "#", 
                                    replacement = "")

mecp2_data_processed_12wk$Cohort <- gsub(x = mecp2_data_processed_12wk$Cohort,
                                    pattern = "#", 
                                    replacement = "")


mecp2_right_6wk <- filter(mecp2_data_processed_6wk, Hemisphere=="RH")
mecp2_left_6wk <- filter(mecp2_data_processed_6wk, Hemisphere=="LH")


mecp2_right_12wk <- filter(mecp2_data_processed_12wk, Hemisphere=="RH")
mecp2_left_12wk <- filter(mecp2_data_processed_12wk, Hemisphere=="LH")
```


## Step Seven: Performing ICC analysis for right hemisphere. The small negative values represent that the ICC value is close to zero
```{r echo=FALSE}
#Right hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean1, data = mecp2_right_6wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean1, data = mecp2_right_6wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean1, data = mecp2_right_6wk)

#For Image
icc_img <- ICCbare(x=factor(Image), y= Mean1, data = mecp2_right_6wk)



#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")

#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Right Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  right hemisphere Mean 1 6 week MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```

```{r echo=FALSE}
#Right hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean1, data = mecp2_right_12wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean1, data = mecp2_right_12wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean1, data = mecp2_right_12wk)

#For Image
icc_img <- ICCbare(x=factor(Image), y= Mean1, data = mecp2_right_12wk)



#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")

#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Right Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  right hemisphere Mean 1 12 week MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```


```{r eval=TRUE, echo=FALSE}
#Right hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean2, data = mecp2_right_6wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean2, data = mecp2_right_6wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean2, data = mecp2_right_6wk)

#For Image
icc_img <- ICCbare(x=factor(Image), y= Mean2, data = mecp2_right_6wk)



#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")

#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Right Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  right hemisphere Mean 2 6 week MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```


```{r echo=FALSE}
#Right hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean2, data = mecp2_right_12wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean2, data = mecp2_right_12wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean2, data = mecp2_right_12wk)

#For Image
icc_img <- ICCbare(x=factor(Image), y= Mean2, data = mecp2_right_12wk)



#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")

#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Right Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  right hemisphere Mean 2 12 week MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```


## Step Eight: Performing ICC analysis for left hemisphere. The small negative values indicate an ICC close to zero
```{r eval=TRUE, echo=FALSE}
#Left hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean1, data = mecp2_left_6wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean1, data = mecp2_left_6wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean1, data = mecp2_left_6wk)

#For Image
icc_cell_img <- ICCbare(x=factor(Image), y= Mean1, data = mecp2_left_6wk)

#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")


#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Left Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  left hemisphere Mean 1 6 week MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```

```{r echo=FALSE}
#Left hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean1, data = mecp2_left_12wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean1, data = mecp2_left_12wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean1, data = mecp2_left_12wk)

#For Image
icc_cell_img <- ICCbare(x=factor(Image), y= Mean1, data = mecp2_left_12wk)

#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")


#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Left Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  left hemisphere Mean 1 12 week MECP2 data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```


```{r eval=TRUE, echo=FALSE}
#Left hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean2, data = mecp2_left_6wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean2, data = mecp2_left_6wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean2, data = mecp2_left_6wk)

#For Image
icc_cell_img <- ICCbare(x=factor(Image), y= Mean2, data = mecp2_left_6wk)

#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")


#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Left Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  left hemisphere Mean 2 MECP2 6 week data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```

```{r echo=FALSE}
#Left hemisphere ICC analysis 
#For Cohort
icc_cohort <- ICCbare(x=factor(Cohort), y= Mean2, data = mecp2_left_12wk)

#For Cell type
icc_cell_type <- ICCbare(x=factor(Cell_type), y= Mean2, data = mecp2_left_12wk)


#For Cell number
icc_cell_num <- ICCbare(x=factor(Cell_number), y= Mean2, data = mecp2_left_12wk)

#For Image
icc_cell_img <- ICCbare(x=factor(Image), y= Mean2, data = mecp2_left_12wk)

#Making a data frame
icc_df <- data.frame(Cohort=icc_cohort, Cell_type=icc_cell_type,
                     Cell_num=icc_cell_num, Image=icc_img)

colnames(icc_df) <- c("Cohort", "Cell type", "Cell number", "Image")


#Making that data frame a nicer looking table
gt_icc <- gt(icc_df)
gt_icc %>% tab_header(
  title = "ICC for Left Hemisphere",
  subtitle = "Intraclass Correlation Coefficient (ICC) for  left hemisphere Mean 2 MECP2 12 week data."
 ) %>% cols_align(
  align = "center",
  columns = c("Cohort", "Cell type", "Cell number", "Image")
 ) %>% opt_align_table_header(align = "center")
```



```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for right hemisphere because of the high ICC of Cell type
lme_mod_right=lme(Mean1~Condition, data= mecp2_right_6wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_right,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Right Hemisphere Mean 1 6 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW", 
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```

```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for right hemisphere because of the high ICC of Cell type
lme_mod_right=lme(Mean2~Condition, data= mecp2_right_6wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_right,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Right Hemisphere Mean 2 6 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW",
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```


```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for right hemisphere because of the high ICC of Cell type
lme_mod_right=lme(Mean1~Condition, data= mecp2_right_6wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_right,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Right Hemisphere Mean 1 12 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW", 
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```

```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for right hemisphere because of the high ICC of Cell type
lme_mod_right=lme(Mean2~Condition, data= mecp2_right_6wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_right,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Right Hemisphere Mean 2 12 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW",
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```



```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for left hemisphere because of the high ICC of Cell type
lme_mod_left=lme(Mean1~Condition, data= mecp2_left_6wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_left,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Left Hemisphere Mean 1 6 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW", 
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```

```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for left hemisphere because of the high ICC of Cell type
lme_mod_left=lme(Mean2~Condition, data= mecp2_left_6wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_left,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Left Hemisphere Mean 2 6 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW",
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```

```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for left hemisphere because of the high ICC of Cell type
lme_mod_left=lme(Mean1~Condition, data= mecp2_left_12wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_left,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Left Hemisphere Mean 1 12 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW", 
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```

```{r eval=TRUE, echo=FALSE, message=FALSE}
#Now building an LME for left hemisphere because of the high ICC of Cell type
lme_mod_left=lme(Mean2~Condition, data= mecp2_left_12wk, random = ~ 1|Cell_type)
modelsummary(
  lme_mod_left,
  fmt = 1,
  estimate  = "{estimate} {stars} [{conf.low}, {conf.high}]",
  statistic = NULL,
  conf_level = 0.99,
  title = "Left Hemisphere Mean 2 12 Week",
  coef_rename = c("(Intercept)" = "(Intercept) NH","ConditionNW" = "NW",
                  "ConditionSH" = "SH", "ConditionSW" = "SW"))
```

```{r}
mecp2_6_wk_df <- bind_rows(mecp2_left_6wk, mecp2_right_6wk)
mecp2_12_wk_df <- bind_rows(mecp2_left_12wk, mecp2_right_12wk)


mecp2_6_wk_df <- filter(mecp2_6_wk_df, Condition=="SH" | Condition=="NW")
mecp2_6_wk_df$Condition <- gsub(x = mecp2_6_wk_df$Condition, pattern = "SH", replacement = "Het")
# mecp2_6_wk_df$Condition <- gsub(x = mecp2_6_wk_df$Condition, pattern = "NH", replacement = "Het")
mecp2_6_wk_df$Condition <- gsub(x = mecp2_6_wk_df$Condition, pattern = "SW", replacement = "WT")
mecp2_6_wk_df$Condition <- gsub(x = mecp2_6_wk_df$Condition, pattern = "NW", replacement = "WT")


mecp2_12_wk_df <- filter(mecp2_12_wk_df, Condition=="SH" | Condition=="NW")
mecp2_12_wk_df$Condition <- gsub(x = mecp2_12_wk_df$Condition, pattern = "SH", replacement = "Het")
#mecp2_12_wk_df$Condition <- gsub(x = mecp2_12_wk_df$Condition, pattern = "NH", replacement = "Het")
mecp2_12_wk_df$Condition <- gsub(x = mecp2_12_wk_df$Condition, pattern = "SW", replacement = "WT")
mecp2_12_wk_df$Condition <- gsub(x = mecp2_12_wk_df$Condition, pattern = "NW", replacement = "WT")


head(mecp2_6_wk_df)
head(mecp2_12_wk_df)



mecp2_6wk_simp_pv <- filter(mecp2_6_wk_df, Cell_type=="PNN-pos")
mecp2_6wk_simp_non_pv <- filter(mecp2_6_wk_df, Cell_type=="PNN-neg")
mecp2_12wk_simp_pv <- filter(mecp2_12_wk_df, Cell_type=="PNN-pos")
mecp2_12wk_simp_non_pv <- filter(mecp2_12_wk_df, Cell_type=="PNN-neg")

mecp2_6wk_simp_pv$Condition <- factor(mecp2_6wk_simp_pv$Condition, levels = c("WT", "Het"))
p1 <- ggbetweenstats(data = mecp2_6wk_simp_pv,
               x = Condition,
               y = Mean2,
               title = "6 Week PV Nuclei",
               ylab = "Mean 2 MECP2 Intensity (a.u.)",
               centrality.plotting = TRUE,
               results.subtitle = TRUE)

mecp2_6wk_simp_non_pv$Condition <- factor(mecp2_6wk_simp_non_pv$Condition, levels = c("WT", "Het"))
p2 <- ggbetweenstats(data = mecp2_6wk_simp_non_pv,
               x = Condition,
               y = Mean2,
               title = "6 Week Non-PV Nuclei",
               ylab = "Mean 2 MeCP2 Intensity (a.u.)",
               centrality.plotting = TRUE,
               results.subtitle = TRUE)


mecp2_12wk_simp_pv$Condition <- factor(mecp2_12wk_simp_pv$Condition, levels = c("WT", "Het"))
p3 <- ggbetweenstats(data = mecp2_12wk_simp_pv,
               x = Condition,
               y = Mean2,
               title = "12 Week PV Nuclei",
               ylab = "Mean 2 MECP2 Intensity (a.u.)",
               centrality.plotting = TRUE,
               results.subtitle = TRUE)

mecp2_12wk_simp_non_pv$Condition <- factor(mecp2_12wk_simp_non_pv$Condition, levels = c("WT", "Het"))
p4 <- ggbetweenstats(data = mecp2_12wk_simp_non_pv,
               x = Condition,
               y = Mean2,
               title = "12 Week Non-PV Nuclei",
               ylab = "Mean 2 MeCP2 Intensity (a.u.)",
               centrality.plotting = TRUE,
               results.subtitle = TRUE)


all_plots <- combine_plots(plotlist = list(p1,p2,p3,p4))

```

```{r}
ggsave(plot =all_plots,filename = "~/Desktop/all_plots_nw_sh.png", device = "png", 
       units = "cm", width = 36, height = 36)
```



```{r, echo=FALSE, message=FALSE}
#Given lack of interest in Cell type we will proceed with doing standard t-test
#heat maps for the Condition to Mean 2 comparison
#Subsetting to each individual combination to get same layout as seen in 
#previous analysis
mecp2_data_left_sh_sw_6wk <- filter(mecp2_left_6wk, Condition=="SH" | Condition=="SW")
mecp2_data_left_sh_nh_6wk <- filter(mecp2_left_6wk, Condition=="SH" | Condition=="NH")
mecp2_data_left_sh_nw_6wk <- filter(mecp2_left_6wk, Condition=="SH" | Condition=="NW")
mecp2_data_left_nh_nw_6wk <- filter(mecp2_left_6wk, Condition=="NH" | Condition=="NW")
mecp2_data_left_nh_sw_6wk <- filter(mecp2_left_6wk, Condition=="NH" | Condition=="SW")
mecp2_data_left_nw_sh_6wk <- filter(mecp2_left_6wk, Condition=="NW" | Condition=="SH")
mecp2_data_left_nw_sw_6wk <- filter(mecp2_left_6wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_left_sh_sw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_left_sh_nh_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
sh_nh
sh_nh$n1 <- 43
sh_nh$n2 <- 48
sh_nh$estimate1 <- 4421
sh_nh$estimate2 <- 4096
sh_nh$estimate <- 325



sh_nw <- t_test(data = mecp2_data_left_sh_nw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)


sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"

sh_nw$estimate1 <- 4421
sh_nw$estimate2 <- 4692
sh_nw$estimate <- -271

nh_nw <- t_test(data = mecp2_data_left_nh_nw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_left_nh_sw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)


nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
nh_sw
nh_sw$n1 <- 50
nh_sw$n2 <- 48
nh_sw$estimate1 <- 3826
nh_sw$estimate2 <- 4096
nh_sw$estimate <- -269

nw_sh <- t_test(data = mecp2_data_left_nw_sh_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_left_nw_sw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw
nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
nw_sw
nw_sw$n1 <- 50
nw_sw$n2 <- 43
nw_sw$estimate1 <- 3826
nw_sw$estimate2 <- 4692
nw_sw$estimate <- --865

left_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
left_hemi_df <- left_hemi_df %>% add_significance("p")

left_hemi_df$group1 <- factor(left_hemi_df$group1,
                              levels = c("NH", "SW", "SH"))
left_hemi_df$group2 <- factor(left_hemi_df$group2,
                              levels = c("SW", "NH", "NW"))
left_hemi_df_mean2_6wk <- left_hemi_df

pwc_left_mean2_gt <- left_hemi_df

colnames(pwc_left_mean2_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_left_gt <- gt(pwc_left_mean2_gt)
pwc_left_table <- pwc_left_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean 2 6 Week"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance")) %>%
  tab_options(
    table.width = pct(100)
  )

pwc_left_table

#Saving the table as a .png file for easy insertion into PowerPoint
gtsave(pwc_left_table, filename = "pwc_left_table_mecp2_mean2_6wk.png",
       path = "Figures/Tables/", vwidth=2000)
```


```{r, echo=FALSE, message=FALSE}
#Given lack of interest in Cell type we will proceed with doing standard t-test
#heat maps for the Condition to Mean 2 comparison
#Subsetting to each individual combination to get same layout as seen in 
#previous analysis
mecp2_data_left_sh_sw_12wk <- filter(mecp2_left_12wk, Condition=="SH" | Condition=="SW")
mecp2_data_left_sh_nh_12wk <- filter(mecp2_left_12wk, Condition=="SH" | Condition=="NH")
mecp2_data_left_sh_nw_12wk <- filter(mecp2_left_12wk, Condition=="SH" | Condition=="NW")
mecp2_data_left_nh_nw_12wk <- filter(mecp2_left_12wk, Condition=="NH" | Condition=="NW")
mecp2_data_left_nh_sw_12wk <- filter(mecp2_left_12wk, Condition=="NH" | Condition=="SW")
mecp2_data_left_nw_sh_12wk <- filter(mecp2_left_12wk, Condition=="NW" | Condition=="SH")
mecp2_data_left_nw_sw_12wk <- filter(mecp2_left_12wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_left_sh_sw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_left_sh_nh_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
sh_nh
# sh_nh$n1 <- 97
# sh_nh$n2 <- 100
# sh_nh$statistic <- -1.27
# sh_nh$estimate1 <- 3997
# sh_nh$estimate2 <- 4565
# sh_nh$estimate <- -568



sh_nw <- t_test(data = mecp2_data_left_sh_nw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)


sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"
sh_nw
# sh_nw$statistic <- -1.56
# sh_nw$n1 <- 97
# sh_nw$n2 <- 102
# sh_nw$estimate1 <- 3997
# sh_nw$estimate2 <- 4682
# sh_nw$estimate <- -685

nh_nw <- t_test(data = mecp2_data_left_nh_nw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_left_nh_sw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)


nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
nh_sw
# nh_sw$statistic <- 0.716
# nh_sw$n1 <- 108
# nh_sw$n2 <- 100
# nh_sw$estimate1 <- 4903
# nh_sw$estimate2 <- 4565
# nh_sw$estimate <- 338

nw_sh <- t_test(data = mecp2_data_left_nw_sh_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_left_nw_sw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)


nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
nw_sw
# nw_sw$statistic <- 0.476
# nw_sw$n1 <- 108
# nw_sw$n2 <- 102
# nw_sw$estimate1 <- 4903
# nw_sw$estimate2 <- 4682
# nw_sw$estimate <- 222

left_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
left_hemi_df <- left_hemi_df %>% add_significance("p")

left_hemi_df$group1 <- factor(left_hemi_df$group1,
                              levels = c("NH", "SW", "SH"))
left_hemi_df$group2 <- factor(left_hemi_df$group2,
                              levels = c("SW", "NH", "NW"))
left_hemi_df_mean2_12wk <- left_hemi_df

pwc_left_mean2_gt <- left_hemi_df

colnames(pwc_left_mean2_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_left_gt <- gt(pwc_left_mean2_gt)
pwc_left_table <- pwc_left_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean 2"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance")) %>%
  tab_options(
    table.width = pct(100)
  )

#pwc_left_table

#Saving the table as a .png file for easy insertion into PowerPoint
# gtsave(pwc_left_table, filename = "pwc_left_table_mecp2_mean2.png",
#        path = "Figures/Tables/", vwidth=2000)
```




```{r echo=FALSE, message=FALSE}
#Mean 1 left hemisphere
mecp2_data_left_sh_sw_6wk <- filter(mecp2_left_6wk, Condition=="SH" | Condition=="SW")
mecp2_data_left_sh_nh_6wk <- filter(mecp2_left_6wk, Condition=="SH" | Condition=="NH")
mecp2_data_left_sh_nw_6wk <- filter(mecp2_left_6wk, Condition=="SH" | Condition=="NW")
mecp2_data_left_nh_nw_6wk <- filter(mecp2_left_6wk, Condition=="NH" | Condition=="NW")
mecp2_data_left_nh_sw_6wk <- filter(mecp2_left_6wk, Condition=="NH" | Condition=="SW")
mecp2_data_left_nw_sh_6wk <- filter(mecp2_left_6wk, Condition=="NW" | Condition=="SH")
mecp2_data_left_nw_sw_6wk <- filter(mecp2_left_6wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_left_sh_sw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_left_sh_nh_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
sh_nh 
# sh_nh$n1 <- 97
# sh_nh$n2 <- 100
# sh_nh$statistic <- -1.10
# sh_nh$estimate1 <- 762
# sh_nh$estimate2 <- 875
# sh_nh$estimate <- -112



sh_nw <- t_test(data = mecp2_data_left_sh_nw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nw
sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"
# sh_nw$statistic <- -2.10
# sh_nw$n1 <- 97
# sh_nw$n2 <- 102
# sh_nw$estimate1 <- 762
# sh_nw$estimate2 <- 968
# sh_nw$estimate <- -206

nh_nw <- t_test(data = mecp2_data_left_nh_nw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_left_nh_sw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw
nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
# nh_sw$statistic <- 0.469
# nh_sw$n1 <- 108
# nh_sw$n2 <- 100
# nh_sw$estimate1 <- 920
# nh_sw$estimate2 <- 875
# nh_sw$estimate <- 45.6

nw_sh <- t_test(data = mecp2_data_left_nw_sh_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_left_nw_sw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw
nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
# nw_sw$statistic <- -0.512
# nw_sw$n1 <- 108
# nw_sw$n2 <- 102
# nw_sw$estimate1 <- 920
# nw_sw$estimate2 <- 968
# nw_sw$estimate <- -47.7

left_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
left_hemi_df <- left_hemi_df %>% add_significance("p")

left_hemi_df$group1 <- factor(left_hemi_df$group1,
                              levels = c("NH", "SW", "SH"))
left_hemi_df$group2 <- factor(left_hemi_df$group2,
                              levels = c("SW", "NH", "NW"))
left_hemi_df_mean1_6wk <- left_hemi_df

pwc_left_Mean1_gt <- left_hemi_df

colnames(pwc_left_Mean1_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_left_gt <- gt(pwc_left_Mean1_gt)
pwc_left_table <- pwc_left_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean 1"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance")) %>%
  tab_options(
    table.width = pct(100)
  )

#pwc_left_table

#Saving the table as a .png file for easy insertion into PowerPoint
# gtsave(pwc_left_table, filename = "pwc_left_table_mecp2_mean1.png",
#        path = "Figures/Tables/", vwidth=2000)
```


```{r echo=FALSE, message=FALSE}
#Mean 1 left hemisphere
mecp2_data_left_sh_sw_12wk <- filter(mecp2_left_12wk, Condition=="SH" | Condition=="SW")
mecp2_data_left_sh_nh_12wk <- filter(mecp2_left_12wk, Condition=="SH" | Condition=="NH")
mecp2_data_left_sh_nw_12wk <- filter(mecp2_left_12wk, Condition=="SH" | Condition=="NW")
mecp2_data_left_nh_nw_12wk <- filter(mecp2_left_12wk, Condition=="NH" | Condition=="NW")
mecp2_data_left_nh_sw_12wk <- filter(mecp2_left_12wk, Condition=="NH" | Condition=="SW")
mecp2_data_left_nw_sh_12wk <- filter(mecp2_left_12wk, Condition=="NW" | Condition=="SH")
mecp2_data_left_nw_sw_12wk <- filter(mecp2_left_12wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_left_sh_sw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_left_sh_nh_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
# sh_nh$n1 <- 97
# sh_nh$n2 <- 100
# sh_nh$statistic <- -1.10
# sh_nh$estimate1 <- 762
# sh_nh$estimate2 <- 875
# sh_nh$estimate <- -112



sh_nw <- t_test(data = mecp2_data_left_sh_nw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nw
sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"
# sh_nw$statistic <- -2.10
# sh_nw$n1 <- 97
# sh_nw$n2 <- 102
# sh_nw$estimate1 <- 762
# sh_nw$estimate2 <- 968
# sh_nw$estimate <- -206

nh_nw <- t_test(data = mecp2_data_left_nh_nw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_left_nh_sw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw
nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
# nh_sw$statistic <- 0.469
# nh_sw$n1 <- 108
# nh_sw$n2 <- 100
# nh_sw$estimate1 <- 920
# nh_sw$estimate2 <- 875
# nh_sw$estimate <- 45.6

nw_sh <- t_test(data = mecp2_data_left_nw_sh_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_left_nw_sw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw
nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
# nw_sw$statistic <- -0.512
# nw_sw$n1 <- 108
# nw_sw$n2 <- 102
# nw_sw$estimate1 <- 920
# nw_sw$estimate2 <- 968
# nw_sw$estimate <- -47.7

left_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
left_hemi_df <- left_hemi_df %>% add_significance("p")

left_hemi_df$group1 <- factor(left_hemi_df$group1,
                              levels = c("NH", "SW", "SH"))
left_hemi_df$group2 <- factor(left_hemi_df$group2,
                              levels = c("SW", "NH", "NW"))
left_hemi_df_mean1_12wk <- left_hemi_df

pwc_left_Mean1_gt <- left_hemi_df

colnames(pwc_left_Mean1_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_left_gt <- gt(pwc_left_Mean1_gt)
pwc_left_table <- pwc_left_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean 1"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance")) %>%
  tab_options(
    table.width = pct(100)
  )

#pwc_left_table

#Saving the table as a .png file for easy insertion into PowerPoint
# gtsave(pwc_left_table, filename = "pwc_left_table_mecp2_mean1.png",
#        path = "Figures/Tables/", vwidth=2000)
```


## Do same as above but for right hemisphere data.
```{r tidy=TRUE, tidy.opts=list(arrow=TRUE, indent=2), echo=FALSE, message=FALSE}
#Subsetting to each individual combination to get same layout as seen in
#previous analysis
mecp2_data_right_sh_sw_6wk <- filter(mecp2_right_6wk, Condition=="SH" | Condition=="SW")
mecp2_data_right_sh_nh_6wk <- filter(mecp2_right_6wk, Condition=="SH" | Condition=="NH")
mecp2_data_right_sh_nw_6wk <- filter(mecp2_right_6wk, Condition=="SH" | Condition=="NW")
mecp2_data_right_nh_nw_6wk <- filter(mecp2_right_6wk, Condition=="NH" | Condition=="NW")
mecp2_data_right_nh_sw_6wk <- filter(mecp2_right_6wk, Condition=="NH" | Condition=="SW")
mecp2_data_right_nw_sh_6wk <- filter(mecp2_right_6wk, Condition=="NW" | Condition=="SH")
mecp2_data_right_nw_sw_6wk <- filter(mecp2_right_6wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_right_sh_sw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_right_sh_nh_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
# sh_nh$statistic <- -2.03
# sh_nh$n1 <- 88
# sh_nh$n2 <- 110
# sh_nh$estimate1 <- 3433
# sh_nh$estimate2 <- 4297
# sh_nh$estimate <- -864

sh_nw <- t_test(data = mecp2_data_right_sh_nw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nw
sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"
# sh_nw$statistic <- -4.54
# sh_nw$n1 <- 88
# sh_nw$n2 <- 111
# sh_nw$estimate1 <- 3433
# sh_nw$estimate2 <- 5427
# sh_nw$estimate <- -1994

nh_nw <- t_test(data = mecp2_data_right_nh_nw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_right_nh_sw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw
nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
# nh_sw$statistic <- 2.70
# nh_sw$n1 <- 110
# nh_sw$n2 <- 100
# nh_sw$estimate1 <- 5667
# nh_sw$estimate2 <- 4297
# nh_sw$estimate <- 1370


nw_sh <- t_test(data = mecp2_data_right_nw_sh_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_right_nw_sw_6wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw
nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
# nw_sw$statistic <- 0.464
# nw_sw$n1 <- 110
# nw_sw$n2 <- 111
# nw_sw$estimate1 <- 5667
# nw_sw$estimate2 <- 5427
# nw_sw$estimate <- 240


right_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
right_hemi_df <- right_hemi_df %>% add_significance("p")

right_hemi_df$group1 <- factor(right_hemi_df$group1, levels = c("NH", "SW",
                                                                "SH"))
right_hemi_df$group2 <- factor(right_hemi_df$group2, levels = c("SW", "NH",
                                                                "NW"))
right_hemi_df_mean2_6wk <- right_hemi_df

pwc_right_mean2_gt <- right_hemi_df

colnames(pwc_right_mean2_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_right_gt <- gt(pwc_right_mean2_gt)
pwc_right_table <- pwc_right_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean 2"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance"))

#pwc_right_table
```

```{r fig.show='hide', echo=FALSE}
#Saving the table as a .png file for easy insertion into PowerPoint
# gtsave(pwc_right_table, filename = "pwc_right_table_mecp2_mean2.png",
#        path = "Figures/Tables/", vwidth=2000)
```



```{r tidy=TRUE, tidy.opts=list(arrow=TRUE, indent=2), echo=FALSE, message=FALSE}
#Subsetting to each individual combination to get same layout as seen in
#previous analysis
mecp2_data_right_sh_sw_12wk <- filter(mecp2_right_12wk, Condition=="SH" | Condition=="SW")
mecp2_data_right_sh_nh_12wk <- filter(mecp2_right_12wk, Condition=="SH" | Condition=="NH")
mecp2_data_right_sh_nw_12wk <- filter(mecp2_right_12wk, Condition=="SH" | Condition=="NW")
mecp2_data_right_nh_nw_12wk <- filter(mecp2_right_12wk, Condition=="NH" | Condition=="NW")
mecp2_data_right_nh_sw_12wk <- filter(mecp2_right_12wk, Condition=="NH" | Condition=="SW")
mecp2_data_right_nw_sh_12wk <- filter(mecp2_right_12wk, Condition=="NW" | Condition=="SH")
mecp2_data_right_nw_sw_12wk <- filter(mecp2_right_12wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_right_sh_sw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_right_sh_nh_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
# sh_nh$statistic <- -2.03
# sh_nh$n1 <- 88
# sh_nh$n2 <- 110
# sh_nh$estimate1 <- 3433
# sh_nh$estimate2 <- 4297
# sh_nh$estimate <- -864

sh_nw <- t_test(data = mecp2_data_right_sh_nw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nw
sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"
# sh_nw$statistic <- -4.54
# sh_nw$n1 <- 88
# sh_nw$n2 <- 111
# sh_nw$estimate1 <- 3433
# sh_nw$estimate2 <- 5427
# sh_nw$estimate <- -1994

nh_nw <- t_test(data = mecp2_data_right_nh_nw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_right_nh_sw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw
nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
# nh_sw$statistic <- 2.70
# nh_sw$n1 <- 110
# nh_sw$n2 <- 100
# nh_sw$estimate1 <- 5667
# nh_sw$estimate2 <- 4297
# nh_sw$estimate <- 1370


nw_sh <- t_test(data = mecp2_data_right_nw_sh_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_right_nw_sw_12wk, formula = Mean2~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw
nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
# nw_sw$statistic <- 0.464
# nw_sw$n1 <- 110
# nw_sw$n2 <- 111
# nw_sw$estimate1 <- 5667
# nw_sw$estimate2 <- 5427
# nw_sw$estimate <- 240


right_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
right_hemi_df <- right_hemi_df %>% add_significance("p")

right_hemi_df$group1 <- factor(right_hemi_df$group1, levels = c("NH", "SW",
                                                                "SH"))
right_hemi_df$group2 <- factor(right_hemi_df$group2, levels = c("SW", "NH",
                                                                "NW"))
right_hemi_df_mean2_12wk <- right_hemi_df

pwc_right_mean2_gt <- right_hemi_df

colnames(pwc_right_mean2_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_right_gt <- gt(pwc_right_mean2_gt)
pwc_right_table <- pwc_right_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean 2"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance"))

#pwc_right_table
```

```{r fig.show='hide', echo=FALSE}
#Saving the table as a .png file for easy insertion into PowerPoint
# gtsave(pwc_right_table, filename = "pwc_right_table_mecp2_mean2.png",
#        path = "Figures/Tables/", vwidth=2000)
```




```{r tidy=TRUE, tidy.opts=list(arrow=TRUE, indent=2), echo=FALSE, message=FALSE}
#Mean 1 right hemisphere
#Subsetting to each individual combination to get same layout as seen in
#previous analysis
mecp2_data_right_sh_sw_6wk <- filter(mecp2_right_6wk, Condition=="SH" | Condition=="SW")
mecp2_data_right_sh_nh_6wk <- filter(mecp2_right_6wk, Condition=="SH" | Condition=="NH")
mecp2_data_right_sh_nw_6wk <- filter(mecp2_right_6wk, Condition=="SH" | Condition=="NW")
mecp2_data_right_nh_nw_6wk <- filter(mecp2_right_6wk, Condition=="NH" | Condition=="NW")
mecp2_data_right_nh_sw_6wk <- filter(mecp2_right_6wk, Condition=="NH" | Condition=="SW")
mecp2_data_right_nw_sh_6wk <- filter(mecp2_right_6wk, Condition=="NW" | Condition=="SH")
mecp2_data_right_nw_sw_6wk <- filter(mecp2_right_6wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_right_sh_sw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_right_sh_nh_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
# sh_nh$statistic <- -0.713
# sh_nh$n1 <- 88
# sh_nh$n2 <- 110
# sh_nh$estimate1 <- 744
# sh_nh$estimate2 <- 814
# sh_nh$estimate <- -70.2

sh_nw <- t_test(data = mecp2_data_right_sh_nw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nw
sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"
# sh_nw$statistic <- -3.22
# sh_nw$n1 <- 88
# sh_nw$n2 <- 111
# sh_nw$estimate1 <- 744
# sh_nw$estimate2 <- 1071
# sh_nw$estimate <- -327

nh_nw <- t_test(data = mecp2_data_right_nh_nw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_right_nh_sw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw
nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
# nh_sw$statistic <- 2.33
# nh_sw$n1 <- 110
# nh_sw$n2 <- 100
# nh_sw$estimate1 <- 1046
# nh_sw$estimate2 <- 814
# nh_sw$estimate <- 232


nw_sh <- t_test(data = mecp2_data_right_nw_sh_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_right_nw_sw_6wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw
nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
# nw_sw$statistic <- -0.245
# nw_sw$n1 <- 110
# nw_sw$n2 <- 111
# nw_sw$estimate1 <- 1046
# nw_sw$estimate2 <- 1071
# nw_sw$estimate <- -25.1


right_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
right_hemi_df <- right_hemi_df %>% add_significance("p")

right_hemi_df$group1 <- factor(right_hemi_df$group1, levels = c("NH", "SW",
                                                                "SH"))
right_hemi_df$group2 <- factor(right_hemi_df$group2, levels = c("SW", "NH",
                                                                "NW"))
right_hemi_df_mean1_6wk <- right_hemi_df

pwc_right_Mean1_gt <- right_hemi_df

colnames(pwc_right_Mean1_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_right_gt <- gt(pwc_right_Mean1_gt)
pwc_right_table <- pwc_right_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean1"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance"))

#pwc_right_table
```

```{r results='hide', fig.show='hide', echo=FALSE}
#Saving the table as a .png file for easy insertion into PowerPoint
# gtsave(pwc_right_table, filename = "pwc_right_table_mecp2_mean1.png",
#        path = "Figures/Tables/", vwidth=2000)
```


```{r tidy=TRUE, tidy.opts=list(arrow=TRUE, indent=2), echo=FALSE, message=FALSE}
#Mean 1 right hemisphere
#Subsetting to each individual combination to get same layout as seen in
#previous analysis
mecp2_data_right_sh_sw_12wk <- filter(mecp2_right_12wk, Condition=="SH" | Condition=="SW")
mecp2_data_right_sh_nh_12wk <- filter(mecp2_right_12wk, Condition=="SH" | Condition=="NH")
mecp2_data_right_sh_nw_12wk <- filter(mecp2_right_12wk, Condition=="SH" | Condition=="NW")
mecp2_data_right_nh_nw_12wk <- filter(mecp2_right_12wk, Condition=="NH" | Condition=="NW")
mecp2_data_right_nh_sw_12wk <- filter(mecp2_right_12wk, Condition=="NH" | Condition=="SW")
mecp2_data_right_nw_sh_12wk <- filter(mecp2_right_12wk, Condition=="NW" | Condition=="SH")
mecp2_data_right_nw_sw_12wk <- filter(mecp2_right_12wk, Condition=="NW" | Condition=="SW")

sh_sw <- t_test(data = mecp2_data_right_sh_sw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh <- t_test(data = mecp2_data_right_sh_nh_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nh
sh_nh$group1 <- "SH"
sh_nh$group2 <- "NH"
# sh_nh$statistic <- -0.713
# sh_nh$n1 <- 88
# sh_nh$n2 <- 110
# sh_nh$estimate1 <- 744
# sh_nh$estimate2 <- 814
# sh_nh$estimate <- -70.2

sh_nw <- t_test(data = mecp2_data_right_sh_nw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

sh_nw
sh_nw$group1 <- "SH"
sh_nw$group2 <- "NW"
# sh_nw$statistic <- -3.22
# sh_nw$n1 <- 88
# sh_nw$n2 <- 111
# sh_nw$estimate1 <- 744
# sh_nw$estimate2 <- 1071
# sh_nw$estimate <- -327

nh_nw <- t_test(data = mecp2_data_right_nh_nw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw <- t_test(data = mecp2_data_right_nh_sw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nh_sw
nh_sw$group1 <- "SW"
nh_sw$group2 <- "NH"
# nh_sw$statistic <- 2.33
# nh_sw$n1 <- 110
# nh_sw$n2 <- 100
# nh_sw$estimate1 <- 1046
# nh_sw$estimate2 <- 814
# nh_sw$estimate <- 232


nw_sh <- t_test(data = mecp2_data_right_nw_sh_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw <- t_test(data = mecp2_data_right_nw_sw_12wk, formula = Mean1~Condition,
                p.adjust.method = "none", conf.level = 0.99, detailed = TRUE)

nw_sw
nw_sw$group1 <- "SW"
nw_sw$group2 <- "NW"
# nw_sw$statistic <- -0.245
# nw_sw$n1 <- 110
# nw_sw$n2 <- 111
# nw_sw$estimate1 <- 1046
# nw_sw$estimate2 <- 1071
# nw_sw$estimate <- -25.1


right_hemi_df <- rbind(nh_nw,nh_sw,nw_sw, sh_sw,sh_nh, sh_nw)
right_hemi_df <- right_hemi_df %>% add_significance("p")

right_hemi_df$group1 <- factor(right_hemi_df$group1, levels = c("NH", "SW",
                                                                "SH"))
right_hemi_df$group2 <- factor(right_hemi_df$group2, levels = c("SW", "NH",
                                                                "NW"))
right_hemi_df_mean1_12wk <- right_hemi_df

pwc_right_Mean1_gt <- right_hemi_df

colnames(pwc_right_Mean1_gt) <- c("Estimate","Estimate1","Estimate2","Response", "Group 1",
                                 "Group 2", "N1", 
                                 "N2", "Statistic","P-value", "DF", "Conf low",
                                 "Conf high", "Method", "Alternative",
                                 "P-value Significance")


pwc_right_gt <- gt(pwc_right_Mean1_gt)
pwc_right_table <- pwc_right_gt %>% tab_header(
  title = "Pairwise T-test Analysis Mean1"
) %>% cols_align(
  align = "center",
  columns = c("Estimate","Estimate1","Estimate2","Response", "Group 1",
              "Group 2", "N1", 
              "N2", "Statistic","P-value", "DF", "Conf low",
              "Conf high", "Method", "Alternative",
              "P-value Significance"))

#pwc_right_table
```

```{r results='hide', fig.show='hide', echo=FALSE}
#Saving the table as a .png file for easy insertion into PowerPoint
# gtsave(pwc_right_table, filename = "pwc_right_table_mecp2_mean1.png",
#        path = "Figures/Tables/", vwidth=2000)
```




## Plotting the heatmaps
```{r, echo=FALSE, out.width="50%", fig.show='hold', fig.keep='all'}
#Heatmap for Mean 2 left hemisphere
mid <- 0


left_heatmap <-ggplot(data = left_hemi_df_mean2_6wk, aes(x=group1, y=group2,
                                               fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 2 Left 6 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/left_hemi_mean2_6wk.svg",
       plot     = print(left_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")


#Heatmap for Mean 2 right hemisphere
mid <- 0

right_heatmap <-ggplot(data = right_hemi_df_mean2_6wk, aes(x=group1, y=group2,
                                                 fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 2 Right 6 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/right_hemi_mean2_6wk.svg",
       plot     = print(right_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")

```

```{r echo=FALSE, out.width="50%", fig.show='hold', fig.keep='all'}
#Heatmap for Mean 1 left hemisphere
mid <- 0


left_heatmap <-ggplot(data = left_hemi_df_mean1_6wk, aes(x=group1, y=group2,
                                               fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 1 Left 6 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/left_hemi_mean1_6wk.svg",
       plot     = print(left_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")


#Heatmap for Mean 1 right hemisphere
mid <- 0

right_heatmap <-ggplot(data = right_hemi_df_mean1_6wk, aes(x=group1, y=group2,
                                                 fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 1 Right 6 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/right_hemi_mean1_6wk.svg",
       plot     = print(right_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")
```


```{r, echo=FALSE, out.width="50%", fig.show='hold', fig.keep='all'}
#Heatmap for Mean 2 left hemisphere
mid <- 0


left_heatmap <-ggplot(data = left_hemi_df_mean2_12wk, aes(x=group1, y=group2,
                                               fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 2 Left 12 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/left_hemi_mean2_12wk.svg",
       plot     = print(left_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")


#Heatmap for Mean 2 right hemisphere
mid <- 0

right_heatmap <-ggplot(data = right_hemi_df_mean2_12wk, aes(x=group1, y=group2,
                                                 fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 2 Right 12 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/right_hemi_mean2_12wk.svg",
       plot     = print(right_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")

```

```{r echo=FALSE, out.width="50%", fig.show='hold', fig.keep='all'}
#Heatmap for Mean 1 left hemisphere
mid <- 0


left_heatmap <-ggplot(data = left_hemi_df_mean1_12wk, aes(x=group1, y=group2,
                                               fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 1 Left 12 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/left_hemi_mean1_12wk.svg",
       plot     = print(left_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")


#Heatmap for Mean 1 right hemisphere
mid <- 0

right_heatmap <-ggplot(data = right_hemi_df_mean1_12wk, aes(x=group1, y=group2,
                                                 fill=estimate))+
  geom_tile()+
  theme(plot.title = element_text(size = 40, face = "plain", hjust = 0.5),
        panel.background = element_blank(),
        axis.text.y = element_text(size = 30, face = "plain", angle = 90, 
                                   hjust = 0.5),
        axis.text.x = element_text(size = 30, face = "plain"),
        legend.title = element_blank(),
        legend.key.height = unit(60, units = "pt"))+
  ggtitle("Mean 1 Right 12 Week")+
  scale_fill_gradient2(low = "blue", high = "red", midpoint = mid,
                       mid = "white")+
  xlab("")+
  ylab("")+
  coord_equal()+
  geom_text(aes(label=p.signif))

#Now saving the heat map
ggsave(filename = "~/Documents/PhD Program/Hong Lab/Projects/Krishnan-lab-Analysis/Figures/Mecp2_figures/right_hemi_mean1_12wk.svg",
       plot     = print(right_heatmap, newpage = FALSE),
       device   = "svg", dpi=300,
       width    = 32, height = 32,
       units    = "cm")
```



## Overall Conclusion
It appears that the MECP2 data is very different compared to our PNN data. We have very large negative differences when looking at the MECP2 data compared to the mainly positive differences we were seeing in the PNN data. In addition, the range of values for the MECP2 data is much larger than that for the PNN data. It appears we have more signal in the Mean 2 (based on the range of the scale) than Mean 1. The left and right hemispheres do have similar patterns to them for Mean 2 behavior. Mean 1 behavior is more divergent between the hemispheres. It appears that the right hemisphere allows us to see more statistically significant differences between conditions and mean intensity vs. the left hemisphere. This might indicate that their is some kind of asymmetry (I remember Dr. Krishnan asking about this. Not sure if this is what she was meaning when she was talking about hemisphere asymmetry). I need more biological information about PNNs vs. MECP2 to understand what these results mean in a biological context.
